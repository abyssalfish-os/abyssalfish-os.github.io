---
title: 常见问题
linktitle: 常见问题QA
description: 安装、使用中问题与解答.
date: 2023-03-20
categories: [other,deploy]
keywords: [dev,docs,deploy]
menu:
  docs:
    parent: "other"
    weight: 20
weight: 20
sections_weight: 20
toc: true
aliases: [/faq/]
isCJKLanguage: true
---

{{% note %}}
**注意:** 本问题列表来自于大家的使用反馈，会不断完善更新。 
{{% /note %}}

## Q: 支持哪些部署方式?

* 支持从源码进行[编译安装](https://abyssalfish-os.github.io/installation/)。
* 支持Release发行版的安装部署（提供了X86_64下CentOS7下的Release）。
* 支持虚拟机镜像部署（提供了[vmware虚拟镜像](https://abyssalfish-os.github.io/downloads/))


## Q: 各类型功能节点部署方式?

* 采集、分析、管理、可视化界面可集成部署于同一机器内，也可部署于不同机器。建议根据实际流量大小和节点性能进行适当划分。
* 小流量环境下，四个模块可以部署于一个节点上。
* 采集、分析部署于同一节点环境下，前端UI才可检索展示数据包相关信息。这是由于目前采集节点可留存用于追溯威胁的数据包，但是仅留存于采集节点本地。建议采集、分析节点同机部署。


## Q: 如何测试流量数据包?
可以考虑以下两种方式：
1. 正常启动探针，监听网卡流量，使用tcpreplay或类似数据包回放工具，将ly_probe中所附测试数据包回放至指定网卡，采集流量netflow信息。
2. 指定探针参数 `-i` 数据包文件，直接读取测试数据包，将采集数据包netflow信息。


## Q: 如何测试系统数据流转正常?
可以从以下步骤，进行系统数据流转测试验证：
1. 启动探针监听网卡，接入回放的流量或真实流量。
2. 验证接收器能够正常接收数据： `/data/flow/3/` 目录下是否存在 `nfcapd` 文件，且单个文件大小大于376字节。
3. 分析引擎正常产出数据： `/Agent/data/db/` 目录下是否存在 以日期命名的目录，且日期目录中不为空。
4. 管理端、Web可视化页面正常显示数据：WEB端访问正常，检测到测试数据包中包含的告警事件。

{{% note %}}
**注意:** 系统为流水线式作业，每个节点间数据流转存在约5分钟的时间差，从接入流量至web端监测到事件，存在10分钟左右的延迟。
{{% /note %}}


## Q: 安装部署后，发现数据写入失败的问题。
可能是目录权限问题。查看 /Agent/data 目录权限，修改为 apache:apache 权属。


## Q: 如何配置两个探针？
探针和采集器一一对应，第二个probe需对应启动第二个cap
1. 采集器nfcap启动时，`-p`参数指定监听的端口，`-I`指定接收到的数据存储的位置。第二个采集器调整为类似`/Agent/bin/nfcapd -w -D -l /data/flow/5 -p 9996`
2. 探针中参数，`-i`指定网卡，`-n`指定数据发向的位置。第二个探针参数修改-n类似为`-n 127.0.0.1:9996`,对应接收器的端口。
3. 登录系统界面，在菜单“配置”-“系统”-“数据节点”下，默认存在两个数据节点配置，只需修改第二条配置“禁止使用”即可。
